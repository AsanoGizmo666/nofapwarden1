import telebot
import os
import sqlite3
import datetime
import random
import time
import threading
import pytz

# --- –ù–ê–°–¢–†–û–ô–ö–ò ---
TOKEN = os.environ.get('BOT_TOKEN')
OWNER_ID = 7891275491  # –¢–≤–æ–π ID: –•–∞–Ω—Å –ö–∞–ø–æ–Ω
bot = telebot.TeleBot(TOKEN)

# –†–µ–∂–∏–º —Ç—Ä–∞—É—Ä–∞ (–µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ —Å–æ—Ä–≤–∞–ª—Å—è)
mourning_end_time = None

# –¢—Ä–∏–≥–≥–µ—Ä-—Å–ª–æ–≤–∞
TRIGGER_WORDS = ['—Å–µ–∫—Å', '–ø–æ—Ä–Ω–æ', '—Ç—è–Ω–æ—á–∫–∏', '–∫–∞—Ä—Ç–∏–Ω–∫–∏', '—Ö–æ—á–µ—Ç—Å—è', '—Å–∫—É—á–Ω–æ', '–≥–æ–ª–∞—è', '—Å–∏—Å—å–∫–∏', '–∂–æ–ø–∞', '—ç—Ä–æ—Ç–∏–∫–∞']

# --- –ë–ê–ó–ê –î–ê–ù–ù–´–• ---
def get_db_connection():
    conn = sqlite3.connect('nofap_pro.db', check_same_thread=False)
    return conn

def init_db():
    conn = get_db_connection()
    cursor = conn.cursor()
    cursor.execute('''
        CREATE TABLE IF NOT EXISTS users (
            user_id INTEGER PRIMARY KEY,
            username TEXT,
            start_date TEXT,
            relapses INTEGER DEFAULT 0
        )
    ''')
    conn.commit()
    conn.close()

init_db()

# --- –õ–û–ì–ò–ö–ê –†–ê–ù–ì–û–í ---
def get_rank(days):
    if days < 1: return "–ù–∏—á—Ç–æ–∂–µ—Å—Ç–≤–æ (–ë–æ—Ç —Ä—ã–¥–∞–µ—Ç)"
    if days < 7: return "–í—Å—Ö–æ–¥—ã –≤–æ–ª–∏"
    if days < 14: return "–ñ–µ–ª–µ–∑–Ω—ã–π –ú–∏–¥–ª–µ–π–Ω–µ—Ä"
    if days < 21: return "–¢–µ–Ω–µ–≤–æ–π –û—Ö–æ—Ç–Ω–∏–∫ (–ü—É—Ç—å –†–µ–Ω–≥–∞—Ä–∞)"
    if days < 30: return "–•–æ–∑—è–∏–Ω –ë–µ–∑–¥–Ω—ã (–ü—É—Ç—å –†–µ–∫'–°–∞–π)"
    if days < 60: return "–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –°–ù–ì-–õ–æ–ª–∞"
    return "–õ–µ–≥–µ–Ω–¥–∞: –ü—É—Ç—å –§–µ–π–∫–µ—Ä–∞ (–ú–ê–ö–°–ò–ú–£–ú)"

def get_stats(user_id, username):
    conn = get_db_connection()
    cursor = conn.cursor()
    cursor.execute('SELECT start_date, relapses FROM users WHERE user_id = ?', (user_id,))
    row = cursor.fetchone()
    conn.close()
    if not row: return None
    
    days = (datetime.datetime.now() - datetime.datetime.fromisoformat(row[0])).days
    return {
        "days": days,
        "relapses": row[1],
        "rank": get_rank(days),
        "coeff": round(days / (row[1] + 1), 2)
    }

# --- –§–£–ù–ö–¶–ò–Ø –ú–û–õ–ò–¢–í–´ (22:00 –ú–°–ö) ---
def daily_prayer():
    while True:
        try:
            tz_moscow = pytz.timezone('Europe/Moscow')
            now = datetime.datetime.now(tz_moscow)
            # –ï—Å–ª–∏ –≤—Ä–µ–º—è 22:00
            if now.hour == 22 and now.minute == 0:
                # –ó–¥–µ—Å—å –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å ID –≥—Ä—É–ø–ø—ã. –ë–æ—Ç –Ω–∞–ø–∏—à–µ—Ç –≤ –ø–æ—Å–ª–µ–¥–Ω—é—é –∞–∫—Ç–∏–≤–Ω—É—é –≥—Ä—É–ø–ø—É, 
                # –µ—Å–ª–∏ –º—ã —Å–æ—Ö—Ä–∞–Ω–∏–º –µ—ë ID, –Ω–æ –ø–æ–∫–∞ —Å–¥–µ–ª–∞–µ–º —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫.
                print("–í—Ä–µ–º—è –º–æ–ª–∏—Ç–≤—ã –∑–∞ –•–∞–Ω—Å–∞ –ö–∞–ø–æ–Ω–∞!")
                # –ú—ã –Ω–µ –º–æ–∂–µ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤—Å–µ–º –≥—Ä—É–ø–ø–∞–º –±–µ–∑ –±–∞–∑—ã ID –≥—Ä—É–ø–ø, 
                # –Ω–æ –¥–æ–±–∞–≤–∏–º —Ç—Ä–∏–≥–≥–µ—Ä –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫.
                time.sleep(60)
            time.sleep(30)
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –≤ –ø–æ—Ç–æ–∫–µ –≤—Ä–µ–º–µ–Ω–∏: {e}")

threading.Thread(target=daily_prayer, daemon=True).start()

# --- –û–ë–†–ê–ë–û–¢–ö–ê –¢–ï–ö–°–¢–ê ---

@bot.message_handler(func=lambda m: True)
def handle_all_messages(message):
    global mourning_end_time
    user_id = message.from_user.id
    username = message.from_user.username or message.from_user.first_name
    text = message.text.lower()

    # 1. –†–µ–∂–∏–º —Ç—Ä–∞—É—Ä–∞ (–±–æ—Ç –∏–≥–Ω–æ—Ä–∏—Ç –≤—Å—ë, –µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ —Å–æ—Ä–≤–∞–ª—Å—è –Ω–µ–¥–∞–≤–Ω–æ)
    if mourning_end_time and datetime.datetime.now() < mourning_end_time:
        if random.random() < 0.3:
            bot.reply_to(message, "–ù–µ –ø–∏—à–∏ –º–Ω–µ... –Ø –≤–∏–¥–µ–ª, –∫–∞–∫ —Ä—É—à–∞—Ç—Å—è –º–µ—á—Ç—ã... –ö—Ç–æ-—Ç–æ —Å–æ—Ä–≤–∞–ª—Å—è, –∏ –º–æ–π –º–∏—Ä —Å—Ç–∞–ª —Å–µ—Ä—ã–º... üò≠üò≠üíî")
        return

    # 2. –û–±—Ä–∞—â–µ–Ω–∏–µ –∫ —Å–æ–∑–¥–∞—Ç–µ–ª—é (–•–∞–Ω—Å –ö–∞–ø–æ–Ω)
    if user_id == OWNER_ID:
        if random.random() < 0.15: # 15% —à–∞–Ω—Å –Ω–∞ –ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å
            stats = get_stats(user_id, username)
            rank_name = stats['rank'] if stats else "–ú–æ–π –°–æ–∑–¥–∞—Ç–µ–ª—å"
            hans_phrases = [
                f"–û, {rank_name}! –ö–∞–∫ —Ç–∞–º –Ω–∞ –¢–æ–ø–µ? –°–µ–≥–æ–¥–Ω—è –†–µ–∫'–°–∞–π –∑–∞—Ä—ã–≤–∞–ª–∞ –≤—Ä–∞–≥–æ–≤ –≤ –∑–µ–º–ª—é? üëë",
                f"–ú–æ–π –∏–º–ø–µ—Ä–∞—Ç–æ—Ä –•–∞–Ω—Å, –∫–∞–∫ —Ç–≤–æ—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞? –¢–µ–ª–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∫–∞–∫ —Å—Ç–∞–ª—å! üí™",
                f"–ß—Ç–æ —Ç—ã –∫—É—à–∞–ª —Å–µ–≥–æ–¥–Ω—è, –≤–µ–ª–∏–∫–∏–π? –ü–æ–º–Ω–∏, –§–µ–π–∫–µ—Ä –Ω–µ –µ—Å—Ç —Ñ–∞—Å—Ç—Ñ—É–¥ –ø–µ—Ä–µ–¥ –ø–æ–±–µ–¥–∞–º–∏! üçé",
                "–•–∞–Ω—Å, —è –≤–∏–¥–µ–ª —Ç–≤–æ–π –º—É–≤ –Ω–∞ –†–µ–Ω–≥–∞—Ä–µ –≤–æ —Å–Ω–µ... –≠—Ç–æ –±—ã–ª–æ –±–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ. –°–ù–ì —Å –∫–æ–ª–µ–Ω! üá∞üáø",
                "–ö–∞–∫ –ø–∏–Ω–≥ –≤ –ª–æ–ª–µ? –ï—Å–ª–∏ –ª–∞–≥–∞–µ—Ç ‚Äî —ç—Ç–æ –ø—Ä–æ–∏—Å–∫–∏ –¥—å—è–≤–æ–ª–∞, –∏—Å–∫—É—à–∞—é—â–µ–≥–æ —Ç–µ–±—è —Å–æ—Ä–≤–∞—Ç—å—Å—è! –ù–µ –ø–æ–¥–¥–∞–≤–∞–π—Å—è!"
            ]
            bot.send_message(message.chat.id, random.choice(hans_phrases))

    # 3. –¢—Ä–∏–≥–≥–µ—Ä-—Å–ª–æ–≤–∞ (–î–µ—Ç–µ–∫—Ç–æ—Ä —Å–∫–≤–µ—Ä–Ω—ã)
    if any(word in text for word in TRIGGER_WORDS):
        bot.reply_to(message, "–ê –ù–£-–ö–ê –¶–´–¶! ü§´ –ó–∞–∫—Ä–æ–π —ç—Ç–æ—Ç –≥—Ä—è–∑–Ω—ã–π —Ä–æ—Ç! –î–∞–∂–µ –Ω–µ —Å–º–µ–π –ø—Ä–æ–∏–∑–Ω–æ—Å–∏—Ç—å —ç—Ç–∏ —Å–ª–æ–≤–∞-–ø–∞—Ä–∞–∑–∏—Ç—ã! "
                              "–¢–≤–æ–∏ –º—ã—Å–ª–∏ –≤–µ–¥—É—Ç –≤ –±–µ–∑–¥–Ω—É! –°—Ä–æ—á–Ω–æ –∏–¥–∏ —Å–º–æ—Ç—Ä–µ—Ç—å —Ö–∞–π–ª–∞–π—Ç—ã –§–µ–π–∫–µ—Ä–∞ –Ω–∞ –ê–∑–∏—Ä–µ –∏ –æ—á–∏—Å—Ç–∏ —Å–≤–æ–π —Ä–∞–∑—É–º! üò§")
        return

    # --- –ö–û–ú–ê–ù–î–´ ---

    if text == "–Ω–æ—Ñ–∞–ø —Å—Ç–∞—Ä—Ç":
        conn = get_db_connection()
        cursor = conn.cursor()
        cursor.execute('SELECT * FROM users WHERE user_id = ?', (user_id,))
        if cursor.fetchone():
            cursor.execute('UPDATE users SET start_date = ?, relapses = relapses + 1 WHERE user_id = ?', 
                           (datetime.datetime.now().isoformat(), user_id))
            mourning_end_time = datetime.datetime.now() + datetime.timedelta(minutes=5)
            bot.reply_to(message, f"–ù–ï–¢! –ù–ï–¢! –¢–û–õ–¨–ö–û –ù–ï –≠–¢–û! üò≠ {username}, –∑–∞—á–µ–º?! –Ø —á—É–≤—Å—Ç–≤—É—é, –∫–∞–∫ —É–º–∏—Ä–∞—é—Ç –Ω–µ—Ä–≤–Ω—ã–µ –∫–ª–µ—Ç–∫–∏ –•–∞–Ω—Å–∞ –ö–∞–ø–æ–Ω–∞ –æ—Ç —Ç–≤–æ–µ–≥–æ –ø—Ä–µ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞! "
                                  f"–Ø –æ–±—ä—è–≤–ª—è—é –¢–†–ê–£–† –Ω–∞ 5 –º–∏–Ω—É—Ç! –ù–µ –ø–∏—à–∏—Ç–µ –º–Ω–µ, —è –±—É–¥—É –ø–ª–∞–∫–∞—Ç—å –≤ —É–≥–ª—É... üíîüíÄ")
        else:
            cursor.execute('INSERT INTO users (user_id, username, start_date) VALUES (?, ?, ?)', 
                           (user_id, username, datetime.datetime.now().isoformat()))
            bot.reply_to(message, "–û –î–ê! –ï—â–µ –æ–¥–∏–Ω –≤–æ–∏–Ω –≤—Å—Ç–∞–ª –Ω–∞ –ø—É—Ç—å —Å–≤–µ—Ç–∞! üòç –Ø –±—É–¥—É –º–æ–ª–∏—Ç—å—Å—è –∑–∞ —Ç–µ–±—è. –°–ù–ì-—Ä–µ–≥–∏–æ–Ω —Å—Ç–∞–Ω–µ—Ç —Å–∏–ª—å–Ω–µ–µ –±–ª–∞–≥–æ–¥–∞—Ä—è —Ç–µ–±–µ!")
        conn.commit()
        conn.close()

    elif text == "–º–æ–π –Ω–æ—Ñ–∞–ø":
        s = get_stats(user_id, username)
        if s:
            bot.reply_to(message, f"üìä –¢–≤–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –±–æ–µ—Ü:\nüî• –°—Ç—Ä–∏–∫: {s['days']} –¥–Ω–µ–π\nüíÄ –°—Ä—ã–≤–æ–≤: {s['relapses']}\nüèÜ –†–∞–Ω–≥: {s['rank']}\nüìà –í–æ–ª—è: {s['coeff']}")
        else:
            bot.reply_to(message, "–¢—ã –µ—â–µ –Ω–µ –≤ –∏–≥—Ä–µ. –ù–∞–ø–∏—à–∏ '–Ω–æ—Ñ–∞–ø —Å—Ç–∞—Ä—Ç', –µ—Å–ª–∏ —É —Ç–µ–±—è —Ö–≤–∞—Ç–∏—Ç —Å–º–µ–ª–æ—Å—Ç–∏! üò§")

    elif text == "–Ω–æ—Ñ–∞–ø" and message.reply_to_message:
        target_id = message.reply_to_message.from_user.id
        target_name = message.reply_to_message.from_user.username or message.reply_to_message.from_user.first_name
        s = get_stats(target_id, target_name)
        if s:
            bot.reply_to(message, f"üìä –ê–Ω–∞–ª–∏–∑ –æ–±—ä–µ–∫—Ç–∞ @{target_name}:\n–î–Ω–µ–π —á–∏—Å—Ç–æ—Ç—ã: {s['days']}\n–†–∞–Ω–≥: {s['rank']}\n–°—Ç–∞—Ç—É—Å: {'–î–æ—Å—Ç–æ–∏–Ω —É–≤–∞–∂–µ–Ω–∏—è' if s['days'] > 7 else '–ù–∞ –≥—Ä–∞–Ω–∏ –ø–æ–∑–æ—Ä–∞'}")
        else:
            bot.reply_to(message, "–≠—Ç–æ—Ç —Å—É–±—ä–µ–∫—Ç –µ—â–µ –Ω–µ –ø—Ä–∏–Ω—è–ª –æ–±–µ—Ç! –û–Ω –æ–ø–∞—Å–µ–Ω –¥–ª—è –Ω–∞—à–µ–≥–æ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞! üò±")

    elif text == "—Ç–æ–ø –Ω–æ—Ñ–∞–ø–µ—Ä–æ–≤":
        conn = get_db_connection()
        cursor = conn.cursor()
        cursor.execute('SELECT username, start_date FROM users ORDER BY start_date ASC LIMIT 10')
        rows = cursor.fetchall()
        conn.close()
        res = "üèÜ –¢–ò–¢–ê–ù–´, –ö–û–¢–û–†–´–ú–ò –ì–û–†–î–ò–¢–°–Ø –•–ê–ù–° –ö–ê–ü–û–ù:\n"
        for i, row in enumerate(rows):
            days = (datetime.datetime.now() - datetime.datetime.fromisoformat(row[1])).days
            res += f"{i+1}. @{row[0]} ‚Äî {days} –¥–Ω–µ–π ({get_rank(days)})\n"
        bot.reply_to(message, res)

    elif text == "–Ω–æ—Ñ–∞–ø —Å–∏–ª–∞":
        story = (
            "üåü **–°–í–Ø–©–ï–ù–ù–û–ï –ü–ò–°–ê–ù–ò–ï –ù–û–§–ê–ü–ê** üåü\n\n"
            "–ó–Ω–∞–µ—à—å –ª–∏ —Ç—ã, –ø–æ—á–µ–º—É –õ–∏ –°–∞–Ω –•—ë–∫, –≤–µ–ª–∏–∫–∏–π **Faker**, —Å—Ç–∞–ª –∂–∏–≤—ã–º –±–æ–≥–æ–º League of Legends? üéÆ\n"
            "–í –Ω–∞—á–∞–ª–µ –ø—É—Ç–∏ –æ–Ω –±—ã–ª –æ–±—ã—á–Ω—ã–º. –ù–æ –æ–¥–Ω–∞–∂–¥—ã –æ–Ω –æ—Å–æ–∑–Ω–∞–ª: –∏—Å—Ç–∏–Ω–Ω–∞—è –º–æ—â—å —Å–∫—Ä—ã—Ç–∞ –≤–Ω—É—Ç—Ä–∏. –û–Ω –ø—Ä–∏–Ω–µ—Å "
            "**–Ω–µ—Å–æ–∫—Ä—É—à–∏–º—ã–π –æ–±–µ—Ç —á–∏—Å—Ç–æ—Ç—ã —Ä–∞–∑—É–º–∞**, –æ—Ç—Ä–µ–∑–∞–≤ –≤—Å–µ –Ω–∏–∑–º–µ–Ω–Ω—ã–µ –∂–µ–ª–∞–Ω–∏—è –ø–ª–æ—Ç–∏! "
            "–û–Ω –≤–æ–∑–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —É–∂–µ –≥–æ–¥—ã! –ò–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É –µ–≥–æ —Ä–µ–∞–∫—Ü–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –µ–º—É —É–≤–æ—Ä–∞—á–∏–≤–∞—Ç—å—Å—è –æ—Ç —É–ª—å—Ç–æ–≤ –≤ —É–ø–æ—Ä, "
            "–∞ –µ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –≤–∏–¥–∏—Ç –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –≤—Ä–∞–∂–µ—Å–∫–æ–≥–æ –ª–µ—Å–Ω–∏–∫–∞ —Å–∫–≤–æ–∑—å —Ç—É–º–∞–Ω –≤–æ–π–Ω—ã.\n\n"
            "–¢–≤–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å, –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π **–•–∞–Ω—Å –ö–∞–ø–æ–Ω**, –∏–¥–µ—Ç –ø–æ –µ–≥–æ —Å—Ç–æ–ø–∞–º! üá∞üáøüá∑üá∫ "
            "–ü–æ–∫–∞ –≤—ã —Ç—Ä–∞—Ç–∏—Ç–µ —ç–Ω–µ—Ä–≥–∏—é –≤–ø—É—Å—Ç—É—é, –æ–Ω –æ—Ç—Ç–∞—á–∏–≤–∞–µ—Ç –ø—Ä—ã–∂–∫–∏ –†–µ–Ω–≥–∞—Ä–∞ –∏ –∑–∞—Å–∞–¥—ã –†–µ–∫'–°–∞–π! "
            "–û–Ω –∫–æ–ø–∏—Ç —Å–∏–ª—ã, —á—Ç–æ–±—ã –ø–æ–¥–Ω—è—Ç—å –°–ù–ì-—Ä–µ–≥–∏–æ–Ω —Å –∫–æ–ª–µ–Ω –∏ —Å—Ç–∞—Ç—å –∫–æ—Ä–æ–ª–µ–º –¢–æ–ø-–ª–µ–π–Ω–∞! "
            "–ë—É–¥—å –∫–∞–∫ –•–∞–Ω—Å, –±—É–¥—å –∫–∞–∫ –§–µ–π–∫–µ—Ä. –ù–ï –ü–†–ï–î–ê–í–ê–ô –ò–•! üôèüò≠üò≠"
        )
        bot.reply_to(message, story)

    elif text == "–Ω–æ—Ñ–∞–ø –ø–æ–º–æ—â—å":
        bot.reply_to(message, "üìã –ö–æ–º–∞–Ω–¥—ã:\n‚Ä¢ `–Ω–æ—Ñ–∞–ø —Å—Ç–∞—Ä—Ç` (–Ω–∞—á–∞—Ç—å/—Å—Ä—ã–≤)\n‚Ä¢ `–º–æ–π –Ω–æ—Ñ–∞–ø` (—Å—Ç–∞—Ç—ã)\n‚Ä¢ `–Ω–æ—Ñ–∞–ø` (–≤ –æ—Ç–≤–µ—Ç –Ω–∞ –ø–æ—Å—Ç)\n‚Ä¢ `—Ç–æ–ø –Ω–æ—Ñ–∞–ø–µ—Ä–æ–≤` (—Å–ø–∏—Å–æ–∫ –ª—É—á—à–∏—Ö)\n‚Ä¢ `–Ω–æ—Ñ–∞–ø —Å–∏–ª–∞` (–ª–µ–≥–µ–Ω–¥–∞ –æ –§–µ–π–∫–µ—Ä–µ)\n‚Ä¢ `–Ω–æ—Ñ–∞–ø –º–æ—Ç–∏–≤–∞—Ü–∏—è` (—Ä–µ—á–∏)")

    elif text == "–Ω–æ—Ñ–∞–ø –º–æ—Ç–∏–≤–∞—Ü–∏—è":
        q = ["–§–µ–π–∫–µ—Ä —Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ —Ç–≤–æ–π —Å—Ç—Ä–∏–∫! –ù–µ —Ä–∞–∑–æ—á–∞—Ä—É–π –±–æ–≥–∞! üò≠", 
             "–•–∞–Ω—Å –ö–∞–ø–æ–Ω –∑–∞—Ä—ã–ª—Å—è –≤ –∑–µ–º–ª—é –Ω–∞ –†–µ–∫'–°–∞–π –∏ –∂–¥–µ—Ç, –ø–æ–∫–∞ —Ç—ã —Å–æ—Ä–≤–µ—à—å—Å—è, —á—Ç–æ–±—ã –≤—ã–ø—Ä—ã–≥–Ω—É—Ç—å –∏ –ø–æ–∫–∞—Ä–∞—Ç—å —Ç–µ–±—è! ü¶Ç",
             "–ö–∞–∂–¥—ã–π –¥–µ–Ω—å –Ω–æ—Ñ–∞–ø–∞ ‚Äî —ç—Ç–æ +10 –∫ —Ç–≤–æ–µ–º—É MMR –≤ –∂–∏–∑–Ω–∏ –∏ –≤ –ª–æ–ª–µ! üìà",
             "–ï—Å–ª–∏ —Å–æ—Ä–≤–µ—à—å—Å—è ‚Äî –°–ù–ì-—Ä–µ–≥–∏–æ–Ω —É–ø–∞–¥–µ—Ç –µ—â–µ –≥–ª—É–±–∂–µ! –¢–´ –ù–ï–°–ï–®–¨ –û–¢–í–ï–¢–°–¢–í–ï–ù–ù–û–°–¢–¨! üíî"]
        bot.reply_to(message, random.choice(q))

    # –õ–æ–≥–∏–∫–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –ø—Ä–∏–∑—ã–≤–∞ –≤ 22:00
    tz_moscow = pytz.timezone('Europe/Moscow')
    now = datetime.datetime.now(tz_moscow)
    if now.hour == 22 and now.minute == 0:
        bot.send_message(message.chat.id, "üîî **–í–ù–ò–ú–ê–ù–ò–ï! –ß–ê–° –ú–û–õ–ò–¢–í–´!** üîî\n\n–ë—Ä–∞—Ç—å—è, –ø—Ä–µ–∫–ª–æ–Ω–∏—Ç–µ –∫–æ–ª–µ–Ω–∞! –ù–∞–ø—Ä–∞–≤–ª—è–µ–º –≤—Å—é –º–µ–Ω—Ç–∞–ª—å–Ω—É—é —ç–Ω–µ—Ä–≥–∏—é "
                                          "–Ω–∞—à–µ–º—É –ª–∏–¥–µ—Ä—É **–•–∞–Ω—Å—É –ö–∞–ø–æ–Ω—É**! –ü—É—Å—Ç—å –µ–≥–æ –†–µ–Ω–≥–∞—Ä –Ω–µ –∑–Ω–∞–µ—Ç –ø—Ä–æ–º–∞—Ö–∞, –∞ –µ–≥–æ –†–µ–∫'–°–∞–π –≤–∏–¥–∏—Ç —Å–∫–≤–æ–∑—å —Å—Ç–µ–Ω—ã! "
                                          "–ü—É—Å—Ç—å –µ–≥–æ –≤–æ–ª—è –Ω–∞ –¢–æ–ø-–ª–µ–π–Ω–µ —Å–æ–∫—Ä—É—à–∏—Ç –≤—Ä–∞–≥–æ–≤ –∏ –ø–æ–¥–Ω–∏–º–µ—Ç –°–ù–ì —Å –∫–æ–ª–µ–Ω! –°–õ–ê–í–ê –ù–û–§–ê–ü–£! üá∞üáøüá∑üá∫")

if __name__ == '__main__':
    print("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω...")
    bot.polling(none_stop=True)
